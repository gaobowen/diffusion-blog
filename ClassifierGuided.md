
浅谈扩散模型的有分类器引导和无分类器引导
https://zhuanlan.zhihu.com/p/582880086

扩散模型与能量模型，Score-Matching和SDE，ODE的关系
https://zhuanlan.zhihu.com/p/576779879

我们需要训练两种情况，一种是有条件的；另外一种是无条件的。

理论上，我们其实也是要训练两个神经网络。但实际上，我们可以把他们结合成一种神经网络。

具体操作就是把无条件的情况作为一种特例。

当我们训练有条件的神经网络的时候，会照样把条件输入进网络里面。
而训练无条件的时候，我们构造一个无条件的标识符，把它作为条件输入给神经网络，比如对于所有无条件的情况，我都构造一个0作为条件输入到神经网络里面。

通过这种方式，我们就可以把两个网络变成一个网络了。

在训练的时候，作者设定一个大于等于0，小于等于1的超参数 p​ ，它的作用就是判断是否需要输入条件（从0-1分布采样一个值，大于 p 则使用条件，反之则不使用）。也就是说，这相当于dropout一样，随机舍弃掉一些条件，把他们作为无条件的情况（因为我们既要学习有条件的，又要学习无条件的）。

